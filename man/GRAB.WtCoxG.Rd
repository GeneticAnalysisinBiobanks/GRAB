% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/WtCoxG.R
\name{GRAB.WtCoxG}
\alias{GRAB.WtCoxG}
\title{Weighted Cox regression for genetic association analysis with case ascertainment}
\usage{
GRAB.WtCoxG()
}
\description{
WtCoxG provides an accurate, powerful, and computationally efficient Cox-based
approach for genome-wide time-to-event analyses in study cohorts with case
ascertainment.
}
\details{
\strong{Additional Parameters for \code{GRAB.NullModel()}:}
\itemize{
\item \code{RefAfFile} (character, required): Reference allele frequency file path.
File must contain columns: CHROM, POS, ID, REF, ALT, AF_ref, AN_ref
\item \code{SurvTimeColumn} (character, default: "SurvTime"): Column name in
\code{data} containing survival times
\item \code{IndicatorColumn} (character, default: "Indicator"): Column name in
\code{data} for case-control status (0 = control, 1 = case)
}

\strong{Additional Control Parameters for GRAB.NullModel()}:
\itemize{
\item \code{RefPrevalence} (numeric, required): Population-level disease prevalence
for weighting. Must be in range (0, 0.5)
\item \code{OutlierRatio} (numeric, default: 1.5): IQR multiplier for outlier detection
\item \code{SNPnum} (numeric, default: 1e4): Minimum number of SNPs for batch effect testing
}

\strong{Additional Control Parameters for GRAB.Marker()}:
\itemize{
\item \code{cutoff} (numeric, default: 0.1): Cutoff of batch effect test p-value for
association testing. Variants with batch effect p-value below this cutoff
will be excluded from association testing.
}

\strong{Output file columns}:
\describe{
\item{Pheno}{Phenotype identifier (for multi-trait analysis).}
\item{Marker}{Marker identifier (rsID or CHR:POS:REF:ALT).}
\item{Info}{Marker information in format CHR:POS:REF:ALT.}
\item{AltFreq}{Alternative allele frequency in the sample.}
\item{AltCounts}{Total count of alternative alleles.}
\item{MissingRate}{Proportion of missing genotypes.}
\item{Pvalue}{P-value from the score test.}
\item{zScore}{Z-score from the score test.}
}
}
\examples{
# Step 1: fit null model and test batch effect
PhenoFile <- system.file("extdata", "simuPHENO.txt", package = "GRAB")
PhenoData <- data.table::fread(PhenoFile, header = TRUE)
SparseGRMFile <- system.file("extdata", "SparseGRM.txt", package = "GRAB")
GenoFile <- system.file("extdata", "simuPLINK.bed", package = "GRAB")
RefAfFile <- system.file("extdata", "simuRefAf.txt", package = "GRAB")
OutputFile <- file.path(tempdir(), "resultWtCoxG.txt")

obj.WtCoxG <- GRAB.NullModel(
  survival::Surv(SurvTime, SurvEvent) ~ AGE + GENDER,
  data = PhenoData,
  subjIDcol = "IID",
  method = "WtCoxG",
  traitType = "time-to-event",
  GenoFile = GenoFile,
  SparseGRMFile = SparseGRMFile,
  control = list(RefPrevalence = 0.01, SNPnum = 1e3),
  RefAfFile = RefAfFile,
  SurvTimeColumn = "SurvTime",
  IndicatorColumn = "SurvEvent"
)

# Step2
GRAB.Marker(obj.WtCoxG, GenoFile, OutputFile,
  control = list(nMarkersEachChunk = 5000)
)

head(data.table::fread(OutputFile))

}
