% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GRAB_Null_Model.R
\name{GRAB.NullModel}
\alias{GRAB.NullModel}
\title{Fit a null model for genetic association testing}
\usage{
GRAB.NullModel(
  formula,
  data,
  subjIDcol,
  method,
  traitType,
  GenoFile = NULL,
  GenoFileIndex = NULL,
  SparseGRMFile = NULL,
  control = NULL,
  ...
)
}
\arguments{
\item{formula}{(formula) Formula with response variable(s) on the left and covariates
on the right. Do not include an intercept (added automatically). Missing values
should be coded as \code{NA}. Other values (e.g., -9, -999) are treated as numeric.
For SPAmix with traitType "Residual", multiple response variables are supported.}

\item{data}{(data.frame) Data frame containing response variables and covariates in the formula.
Parameter "subset" is deprecated. All subjects with phenotype data will be used.}

\item{subjIDcol}{(character) Column name in \code{data} containing subject IDs.}

\item{method}{(character) Statistical method. Supported methods:
\itemize{
\item "POLMM": Ordinal traits. See \code{\link{GRAB.POLMM}}.
\item "SPACox": Time-to-event or residual traits. See \code{\link{GRAB.SPACox}}.
\item "SPAmix": Time-to-event or residual traits. See \code{\link{GRAB.SPAmix}}.
\item "WtCoxG": Time-to-event traits. See \code{\link{GRAB.WtCoxG}}.
}}

\item{traitType}{(character) Trait type: "ordinal", "time-to-event", or "Residual".}

\item{GenoFile}{(character or NULL) Path to genotype file (PLINK or BGEN format).
Required for dense GRM construction. GRAB supports both dense and sparse GRM for
relatedness adjustment. Dense GRM is constructed from GenoFile (PLINK/BGEN format).
See \code{\link{GRAB.ReadGeno}} and \code{\link{getTempFilesFullGRM}} for details.}

\item{GenoFileIndex}{(character or NULL) Index files for the genotype file. If \code{NULL}
(default), uses same prefix as \code{GenoFile}. See \code{\link{GRAB.ReadGeno}}
for details.}

\item{SparseGRMFile}{(character or NULL) Path to sparse GRM file. Alternative to
dense GRM construction. Pre-computed sparse GRM matrix.
See \code{\link{getSparseGRM}} for details.}

\item{control}{(list or NULL) List of method-specific control parameters.
See the corresponding method documentation for available options and defaults.}

\item{...}{Additional arguments for method-specific functions.}
}
\value{
S3 object with class "\{method\}_NULL_Model" containing:
\describe{
\item{N}{Sample size in analysis.}
\item{yVec}{Phenotype vector used in analysis.}
\item{beta}{Estimated covariate effect coefficients.}
\item{subjData}{Subject IDs included in analysis.}
\item{sessionInfo}{R session and package information.}
\item{Call}{Function call with all arguments.}
\item{time}{Analysis completion timestamp.}
\item{control}{Control parameters used in fitting.}
\item{tau}{Variance component estimates (for mixed models).}
\item{SparseGRM}{Sparse GRM (if used).}
}

This object serves as input for \code{\link{GRAB.Marker}} and \code{\link{GRAB.Region}}.

For method-specific examples, see:
\itemize{
\item POLMM method: \code{\link{GRAB.POLMM}}
\item SPACox method: \code{\link{GRAB.SPACox}}
\item SPAmix method: \code{\link{GRAB.SPAmix}}
\item WtCoxG method: \code{\link{GRAB.WtCoxG}}
}
}
\description{
Estimates model parameters and residuals from a null model containing phenotypes,
covariates, and optionally a genetic relationship matrix (GRM) for subsequent
association testing.
}
