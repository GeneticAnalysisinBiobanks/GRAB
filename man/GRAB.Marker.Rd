% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GRAB_Marker.R
\name{GRAB.Marker}
\alias{GRAB.Marker}
\title{Perform genome-wide association testing at the marker level}
\usage{
GRAB.Marker(
  objNull,
  GenoFile,
  GenoFileIndex = NULL,
  OutputFile,
  OutputFileIndex = NULL,
  control = NULL
)
}
\arguments{
\item{objNull}{Null model object from \code{\link{GRAB.NullModel}}.}

\item{GenoFile}{Path to genotype file. Supports PLINK (.bed/.bim/.fam) and BGEN formats.
See \code{\link{GRAB.ReadGeno}} for format details.}

\item{GenoFileIndex}{Index files for the genotype file. If \code{NULL} (default), uses
the same prefix as \code{GenoFile}. See \code{\link{GRAB.ReadGeno}} for details.}

\item{OutputFile}{Path for saving association test results.}

\item{OutputFileIndex}{Path for progress tracking file. Enables analysis restart if
interrupted. If \code{NULL} (default), uses \code{paste0(OutputFile, ".index")}.}

\item{control}{List of control parameters. See \code{Details} for available options.}
}
\value{
Results are saved to \code{OutputFile} with the following columns:

\strong{Standard Columns} (included for all methods):
\describe{
\item{Marker}{Marker identifiers from genotype files.}
\item{Info}{Marker information as "CHR:POS:REF:ALT". REF/ALT order depends on
\code{control$AlleleOrder}.}
\item{AltFreq}{Alternative allele frequency before imputation. Values > 0.5 suggest
reconsidering \code{control$AlleleOrder}.}
\item{AltCounts}{Alternative allele counts before imputation.}
\item{MissingRate}{Proportion of missing genotypes per marker.}
\item{Pvalue}{Association test p-value.}
}

\strong{Optional Columns} (controlled by \code{control$outputColumns}):
\describe{
\item{beta}{Effect size estimate for the alternative allele.}
\item{seBeta}{Standard error of the effect size estimate.}
\item{zScore}{Standardized test statistic (approximately standard normal).}
\item{nSamplesInGroup}{Sample counts by phenotype group (may vary due to missing genotypes).}
\item{AltCountsInGroup}{Alternative allele counts by phenotype group before imputation.}
\item{AltFreqInGroup}{Alternative allele frequencies by phenotype group before imputation.}
}

See \code{\link{makeGroup}} for phenotype grouping details used in group-specific statistics.
}
\description{
Conducts single-marker association tests between genetic variants and phenotypes using
various statistical methods supported by GRAB.
}
\details{
GRAB supports multiple association testing methods: \code{POLMM}, \code{SPACox},
\code{SPAGRM}, \code{SPAmix}, and \code{WtCoxG}. The appropriate method is automatically
detected from \code{class(objNull)}. See \code{\link{GRAB.NullModel}} for method details.
\subsection{Control Parameters}{

\strong{Marker Selection}: Control which markers to analyze (default: all markers in file).
\itemize{
\item \code{IDsToIncludeFile}, \code{IDsToExcludeFile}: Include/exclude specific markers.
\item \code{RangesToIncludeFile}, \code{RangesToExcludeFile}: Include/exclude genomic ranges.
\item \code{AlleleOrder}: "alt-first" (PLINK default) or "ref-first" (BGEN default).
}
See \code{\link{GRAB.ReadGeno}} for details on these parameters.

\strong{Quality Control}: Filter markers based on data quality.
\itemize{
\item \code{ImputeMethod}: "mean" (default), "bestguess", or "drop".
\item \code{MissingRateCutoff}: Exclude markers with missing rate > 0.15 (default).
\item \code{MinMAFCutoff}: Exclude markers with MAF < 0.001 (default).
\item \code{MinMACCutoff}: Exclude markers with MAC < 20 (default).
\item \code{nMarkersEachChunk}: Process 10,000 markers per chunk (default).
}

\strong{Output Customization}: Control which columns appear in results.
\itemize{
\item \code{outputColumns}: Additional columns beyond the standard set. Available options
depend on the analysis method:
\itemize{
\item \code{POLMM}: Default: \code{beta}, \code{seBeta}; Optional: \code{zScore},
\code{AltFreqInGroup}, \code{nSamplesInGroup}, \code{AltCountsInGroup}
\item \code{SPACox}: Optional: \code{zScore}
}
}
}
}
\examples{
# Load a precomputed POLMM_NULL_Model object to perform step 2 without repeating step 1
objNullFile <- system.file("extdata", "objPOLMMnull.RData", package = "GRAB")
load(objNullFile)
class(obj.POLMM)

GenoFile <- system.file("extdata", "simuPLINK.bed", package = "GRAB")
OutputFile <- file.path(tempdir(), "simuOUTPUT.txt")
outputColumns <- c(
  "beta", "seBeta", "zScore",
  "nSamplesInGroup", "AltCountsInGroup", "AltFreqInGroup"
)

GRAB.Marker(
  objNull = obj.POLMM,
  GenoFile = GenoFile,
  OutputFile = OutputFile,
  control = list(outputColumns = outputColumns)
)

data.table::fread(OutputFile)

}
