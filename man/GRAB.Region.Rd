% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GRAB_Region.R
\name{GRAB.Region}
\alias{GRAB.Region}
\title{Perform region-based genetic association testing}
\usage{
GRAB.Region(
  objNull,
  GenoFile,
  GenoFileIndex = NULL,
  OutputFile,
  OutputFileIndex = NULL,
  GroupFile,
  SparseGRMFile = NULL,
  SampleFile = NULL,
  MaxMAFVec = "0.01,0.001,0.0005",
  annoVec = "lof,lof:missense,lof:missense:synonymous",
  chrom = "LOCO=F",
  control = NULL
)
}
\arguments{
\item{objNull}{Null model object from \code{\link{GRAB.NullModel}}.}

\item{GenoFile}{Path to genotype file (PLINK or BGEN format). See
\code{\link{GRAB.ReadGeno}} for details.}

\item{GenoFileIndex}{Index files for genotype file. If \code{NULL} (default), uses
same prefix as \code{GenoFile}. See \code{\link{GRAB.ReadGeno}} for details.}

\item{OutputFile}{Path for saving region-based association results.}

\item{OutputFileIndex}{Path for progress tracking file. If \code{NULL} (default),
uses \code{paste0(OutputFile, ".index")}.}

\item{GroupFile}{Path to region definition file specifying region-marker mappings
and annotation information. Tab-separated format with 2-3 columns per region.}

\item{SparseGRMFile}{Path to sparse GRM file (optional).}

\item{SampleFile}{Path to sample information file with header (optional).}

\item{MaxMAFVec}{Comma-separated MAF cutoffs for including variants in analysis
(default: "0.01,0.001,0.0005").}

\item{annoVec}{Comma-separated annotation groups for analysis
(default: "lof,lof:missense,lof:missense:synonymous").}

\item{chrom}{Chromosome-specific options (default: "LOCO=F").}

\item{control}{List of control parameters. See \code{Details} for options.}
}
\value{
Results are saved to two files:
\enumerate{
\item \code{OutputFile}: Region-based test results
\item \code{paste0(OutputFile, ".markerInfo")}: Marker-level results (same format as
\code{\link{GRAB.Marker}})
}

\strong{Region-level results} (\code{OutputFile}) contain:
\describe{
\item{Region}{Region identifiers from \code{GroupFile}.}
\item{Anno.Type}{Annotation type from \code{GroupFile}.}
\item{maxMAF}{Maximum MAF cutoff used for variant selection.}
\item{nSamples}{Number of samples in analysis.}
\item{nMarkers}{Number of markers with MAF < cutoff and MAC > \code{MinMACCutoff}.}
\item{nMarkersURV}{Number of ultra-rare variants with MAC < \code{MinMACCutoff}.}
\item{pval.SKATO}{SKAT-O test p-values.}
\item{pval.SKAT}{SKAT test p-values.}
\item{pval.Burden}{Burden test p-values.}
}
}
\description{
Tests for association between phenotypes and genomic regions containing multiple
genetic variants, primarily low-frequency and rare variants.
}
\details{
GRAB supports region-based testing using multiple methods: \code{POLMM}, \code{SPACox},
\code{SPAGRM}, \code{SPAmix}, and \code{WtCoxG}. The method is automatically detected
from \code{class(objNull)}. See \code{\link{GRAB.NullModel}} for method details.
\subsection{Control Parameters}{

\strong{Genotype Processing:}
\itemize{
\item \code{AlleleOrder}: "alt-first" (PLINK default) or "ref-first" (BGEN default).
\item \code{ImputeMethod}: "mean", "bestguess" (default), or "drop".
\item \code{omp_num_threads}: Number of OpenMP threads for parallel computation.
}

\strong{Quality Control:}
\itemize{
\item \code{MissingRateCutoff}: Exclude markers with missing rate > 0.15 (default).
\item \code{MinMACCutoff}: Treat markers with MAC < 5 (default) as ultra-rare variants.
\item \code{nRegionsEachChunk}: Number of regions per output chunk (default: 1).
}

\strong{Kernel-Based Testing (SKAT/SKAT-O):}
\itemize{
\item \code{kernel}: Kernel type (default: "linear.weighted").
\item \code{weights_beta}: Beta weight parameters (default: c(1, 25)).
\item \code{weights}: Custom weight vector (overrides \code{weights_beta} if specified).
\item \code{r.corr}: Rho parameters for SKAT-O (default: c(0, 0.1^2, 0.2^2, 0.3^2,
0.4^2, 0.5^2, 0.5, 1)).
}

\strong{Output Customization:}
\itemize{
\item \code{outputColumns}: Additional columns for marker-level output.
\itemize{
\item \code{POLMM}: Default: \code{beta}, \code{seBeta}; Optional: \code{zScore},
\code{AltFreqInGroup}, \code{nSamplesInGroup}, \code{AltCountsInGroup}
\item \code{SPACox}: Optional: \code{zScore}
}
}
See \code{\link{GRAB.ReadGeno}} for genotype processing details.
}
}
\examples{
# Load a precomputed example object to perform step 2 without repeating step 1
objNullFile <- system.file("extdata", "objPOLMMnull.RData", package = "GRAB")
load(objNullFile)
class(obj.POLMM) # "POLMM_NULL_Model" is an object from POLMM method.

OutputDir <- tempdir()
OutputFile <- file.path(OutputDir, "simuRegionOutput.txt")
GenoFile <- system.file("extdata", "simuPLINK_RV.bed", package = "GRAB")
GroupFile <- system.file("extdata", "simuPLINK_RV.group", package = "GRAB")
SparseGRMFile <- system.file("extdata", "SparseGRM.txt", package = "GRAB")

GRAB.Region(
  objNull = obj.POLMM,
  GenoFile = GenoFile,
  OutputFile = OutputFile,
  GroupFile = GroupFile,
  SparseGRMFile = SparseGRMFile,
  MaxMAFVec = "0.01,0.005"
)

data.table::fread(OutputFile)
data.table::fread(paste0(OutputFile, ".markerInfo"))
data.table::fread(paste0(OutputFile, ".otherMarkerInfo"))
data.table::fread(paste0(OutputFile, ".index"), sep = "\t", header = FALSE)

}
